# 游戏交易系统

## 项目简介

本项目是一个基于 Python 的**游戏虚拟物品交易与价格监控系统**，集成了库存管理、入库/出库管理、交易监控、数据分析、价格走势可视化、操作日志回退等多项功能。适用于游戏商人、虚拟物品投资者、数据分析爱好者等场景。

## 主要功能

- **库存管理**：实时统计各类物品库存、均价、利润、库存价值等。
- **入库管理**：支持手动和OCR批量导入入库记录，自动计算均价。
- **出库管理**：支持手动和OCR批量导入出库记录，自动校验库存。
- **交易监控**：监控虚拟物品市场价格，支持自定义策略字段。
- **分析报告**：一键生成库存、入库、出库、监控等多维度分析报告。
- **操作日志**：所有增删改操作均有日志记录，支持一键回退/前进，日志可导出。
- **银两价格走势**：抓取并可视化主流平台银两价格，支持多平台对比、导出图表/数据。
- **女娲石价格走势**：抓取并可视化主流平台女娲石价格，功能与银两价格页一致。
- **公式管理**：支持自定义利润、利润率等字段的计算公式。
- **物品字典管理**：自定义物品名词典，提升OCR识别准确率。
- **Server酱推送**：价格异常自动推送微信通知。

## 技术栈

- **前端界面**：Tkinter + ttkbootstrap
- **数据可视化**：matplotlib
- **数据存储**：MySQL（或SQLite，需适配）
- **OCR识别**：支持本地和远程API
- **数据导出**：支持Excel、CSV、PNG等格式

## 目录结构

```
.
├── gui.py                # 主界面与业务逻辑
├── nvwa_price_tab.py     # 女娲石价格标签页（独立模块）
├── db_manager.py         # 数据库操作与表结构
├── inventory_manager.py  # 库存管理相关逻辑
├── trade_analyzer.py     # 数据分析与报表
├── formula_manager.py    # 公式管理窗口
├── recipe_parser.py      # OCR文本解析
├── requirements.txt      # 依赖包列表
├── README.md             # 项目说明文档
├── ...                   # 其它辅助文件
```

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 初始化数据库

- 默认使用 MySQL，需先创建数据库并配置好连接参数（见 `db_manager.py`）。
- 可选：运行 `init_db.py` 自动建表。

### 3. 启动程序

```bash
python gui.py
```

### 4. 功能体验

- 各功能标签页均可直接点击体验。
- 支持右键菜单、双击编辑、批量操作、OCR图片导入等。
- 价格走势页支持平台切换、天数切换、自动刷新、导出等。

## 主要依赖

- `ttkbootstrap`
- `tkinter`
- `matplotlib`
- `requests`
- `pandas`
- `Pillow`
- `numpy`
- `openpyxl`（导出Excel用）

## 截图示例

- **主界面**  
  ![主界面截图](screenshot_main.png)
- **银两/女娲石价格走势**  
  ![价格走势截图](screenshot_price.png)

## 常见问题

- **数据库连接失败**：请检查 `db_manager.py` 的数据库配置。
- **OCR识别失败**：请检查网络或OCR API接口。
- **界面显示异常**：建议使用 Windows 系统，字体推荐微软雅黑。

## 贡献与反馈

欢迎提交 issue 或 PR，或联系作者改进建议！